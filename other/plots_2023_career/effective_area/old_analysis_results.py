import numpy as np
from copy import copy

# digitized limits from Fig. 6 of https://arxiv.org/pdf/1807.01820.pdf
# units:
    # first dimension: energy / GeV
    # second dimension: energy**2 * flux / (GeV cm^-2 s^-1 sr^-1)

# IC86-equivalent livetime for the 9yr analysis
LIVETIME_9YR = 8.15 * 365 * 24 * 3600

diff_limit_9yr = np.array([
    5.29278e+6, 1.14422e-8,
    7.07946e+6, 1.21648e-8,
    8.18762e+6, 1.27756e-8,
    1.00000e+7, 1.39193e-8,
    1.15653e+7, 1.47983e-8,
    1.38709e+7, 1.59268e-8,
    1.69413e+7, 1.73525e-8,
    2.03186e+7, 1.86757e-8,
    2.81838e+7, 1.96134e-8,
    3.56970e+7, 2.03475e-8,
    4.77471e+7, 2.11090e-8,
    7.65968e+7, 2.11090e-8,
    1.12202e+8, 2.08521e-8,
    1.76754e+8, 1.96134e-8,
    2.63665e+8, 1.84483e-8,
    3.52670e+8, 1.80019e-8,
    4.80373e+8, 1.86757e-8,
    6.78545e+8, 1.96134e-8,
    8.75196e+8, 2.05982e-8,
    1.08853e+9, 2.29986e-8,
    1.35388e+9, 2.56788e-8,
    1.74625e+9, 2.90246e-8,
    2.25233e+9, 3.20125e-8,
    2.90508e+9, 3.53079e-8,
    3.81574e+9, 3.89427e-8,
    5.10381e+9, 4.29515e-8,
    6.82670e+9, 5.09855e-8,
    9.29867e+9, 6.20231e-8,
    1.26658e+10, 7.45316e-8,
    1.66361e+10, 8.52808e-8,
    2.34992e+10, 1.02480e-7,
    3.08655e+10, 1.17260e-7,
    3.76978e+10, 1.39193e-7,
    4.86230e+10, 1.73525e-7,
    6.38650e+10, 2.21689e-7,
    7.80019e+10, 2.63156e-7,
]).reshape(-1, 2)

diff_limit_7yr = np.array([
    5.19744e+6, 1.00000e-8,
    7.61341e+6, 1.07584e-8,
    1.01834e+7, 1.18597e-8,
    1.41254e+7, 1.35605e-8,
    2.06914e+7, 1.56952e-8,
    3.20083e+7, 1.66810e-8,
    4.95150e+7, 1.77287e-8,
    7.52170e+7, 1.83887e-8,
    1.16356e+8, 1.90732e-8,
    1.76754e+8, 2.07711e-8,
    2.58915e+8, 2.28975e-8,
    4.00527e+8, 2.49359e-8,
    6.08430e+8, 2.58642e-8,
    9.07601e+8, 2.81667e-8,
    1.30554e+9, 3.26007e-8,
    1.91240e+9, 3.77328e-8,
    2.80136e+9, 4.31440e-8,
    4.17881e+9, 4.87338e-8,
    6.01101e+9, 5.70971e-8,
    8.33782e+9, 6.93857e-8,
    1.13570e+10, 8.32981e-8,
    1.57532e+10, 9.87891e-8,
    2.26602e+10, 1.17161e-7,
    3.20083e+10, 1.40653e-7,
    4.20421e+10, 1.77287e-7,
    5.42264e+10, 2.20757e-7,
    7.12249e+10, 2.81667e-7,
    7.94328e+10, 3.10501e-7,
]).reshape(-1, 2)


# digitized exposures from Fig. 1 of https://arxiv.org/pdf/1607.05886.pdf
# units:
    # first dimension: energy / GeV
    # second dimension: exposure / (cm^2 sr sec)

nue_exposure_7yr = np.array([
    4.94677e+5, 2.52547e+12,
    5.36718e+5, 3.69564e+12,
    5.87100e+5, 5.32628e+12,
    6.47471e+5, 7.59887e+12,
    7.14050e+5, 1.08963e+13,
    7.87476e+5, 1.56246e+13,
    8.75564e+5, 2.21944e+13,
    9.81480e+5, 3.21268e+13,
    1.10922e+6, 4.60385e+13,
    1.26385e+6, 6.44843e+13,
    1.44003e+6, 8.99775e+13,
    1.66777e+6, 1.26895e+14,
    1.97936e+6, 1.76859e+14,
    2.34917e+6, 2.44999e+14,
    2.78808e+6, 3.41372e+14,
    3.33609e+6, 4.47792e+14,
    3.99181e+6, 5.77709e+14,
    4.69912e+6, 7.55360e+14,
    4.93482e+6, 1.12004e+15,
    5.22478e+6, 1.63403e+15,
    5.44226e+6, 2.82723e+15,
    5.62275e+6, 4.44759e+15,
    5.80923e+6, 7.15830e+15,
    5.96934e+6, 1.12467e+16,
    6.10060e+6, 1.46442e+16,
    6.95106e+6, 7.05012e+15,
    7.06538e+6, 2.29134e+15,
    # 7.06538e+6, 5.04301e+15,
    7.16209e+6, 1.57698e+15,
    # 7.18159e+6, 3.66267e+15,
    7.36807e+6, 1.09498e+15,
    9.17258e+6, 1.06677e+15,
    1.25874e+7, 1.20682e+15,
    1.49635e+7, 1.36488e+15,
    1.79047e+7, 1.57190e+15,
    2.14239e+7, 1.81533e+15,
    2.56348e+7, 2.07912e+15,
    3.06735e+7, 2.36809e+15,
    3.67024e+7, 2.69350e+15,
    4.39164e+7, 3.04248e+15,
    5.25484e+7, 3.43668e+15,
    6.28770e+7, 3.88196e+15,
    7.52357e+7, 4.37280e+15,
    9.00235e+7, 4.78456e+15,
    1.07718e+8, 5.23509e+15,
    1.28890e+8, 5.72012e+15,
    1.54224e+8, 6.27610e+15,
    1.84538e+8, 6.84809e+15,
    2.20809e+8, 7.50331e+15,
    2.64210e+8, 8.24402e+15,
    3.16141e+8, 9.05785e+15,
    3.78280e+8, 9.96581e+15,
    4.52633e+8, 1.09648e+16,
    5.41599e+8, 1.20639e+16,
    6.48052e+8, 1.32548e+16,
    7.75430e+8, 1.45431e+16,
    9.27843e+8, 1.59126e+16,
    1.11021e+9, 1.73388e+16,
    1.32843e+9, 1.89715e+16,
    1.58954e+9, 2.07292e+16,
    1.90197e+9, 2.26184e+16,
    2.27581e+9, 2.47482e+16,
    2.72313e+9, 2.68918e+16,
    3.25837e+9, 2.90195e+16,
    3.89881e+9, 3.13589e+16,
    4.66514e+9, 3.38869e+16,
    5.58209e+9, 3.65174e+16,
    6.67927e+9, 3.95159e+16,
    7.99210e+9, 4.28199e+16,
    9.56298e+9, 4.65932e+16,
    1.14426e+10, 5.10512e+16,
    1.36917e+10, 5.55499e+16,
    1.63829e+10, 6.03614e+16,
    1.96030e+10, 6.49571e+16,
    2.34560e+10, 6.86558e+16,
    2.80664e+10, 7.26656e+16,
    3.35829e+10, 7.68033e+16,
    4.01838e+10, 8.19670e+16,
    4.80821e+10, 8.89434e+16,
    5.75328e+10, 9.67812e+16,
    6.88410e+10, 1.05164e+17,
    8.23720e+10, 1.14431e+17,
    9.08423e+10, 1.17970e+17
]).reshape(-1, 2)

numu_exposure_7yr = np.array([
    5.09418e+5, 1.03669e+12,
    5.36718e+5, 1.54345e+12,
    5.72908e+5, 2.22899e+12,
    6.21596e+5, 3.16394e+12,
    6.74423e+5, 4.47739e+12,
    7.31739e+5, 6.31684e+12,
    8.06983e+5, 8.84246e+12,
    8.68452e+5, 1.22769e+13,
    9.65599e+5, 1.71693e+13,
    1.08241e+6, 2.40548e+13,
    1.21334e+6, 3.36286e+13,
    1.36012e+6, 4.71151e+13,
    1.54972e+6, 6.67322e+13,
    1.80950e+6, 9.30077e+13,
    2.13013e+6, 1.30819e+14,
    2.50758e+6, 1.83722e+14,
    2.97608e+6, 2.58091e+14,
    3.56104e+6, 3.32970e+14,
    4.26097e+6, 4.23668e+14,
    5.09848e+6, 5.39817e+14,
    6.10060e+6, 6.87810e+14,
    7.29970e+6, 8.77589e+14,
    8.73448e+6, 1.11664e+15,
    1.04513e+7, 1.42276e+15,
    1.25055e+7, 1.81282e+15,
    1.49635e+7, 2.30661e+15,
    1.79047e+7, 2.75002e+15,
    2.14239e+7, 3.18471e+15,
    2.56348e+7, 3.67791e+15,
    3.06735e+7, 4.25927e+15,
    3.67024e+7, 4.90529e+15,
    4.39164e+7, 5.68066e+15,
    5.25484e+7, 6.56040e+15,
    6.28770e+7, 7.58688e+15,
    7.52357e+7, 8.74971e+15,
    9.00235e+7, 1.01328e+16,
    1.07718e+8, 1.17020e+16,
    1.28890e+8, 1.34582e+16,
    1.54224e+8, 1.51809e+16,
    1.84538e+8, 1.70060e+16,
    2.20809e+8, 1.92626e+16,
    2.64210e+8, 2.21229e+16,
    3.11590e+8, 2.52093e+16,
    4.40971e+8, 2.80167e+16,
    5.24214e+8, 3.19726e+16,
    6.27250e+8, 3.60153e+16,
    7.50538e+8, 4.04010e+16,
    8.98059e+8, 4.54465e+16,
    1.07458e+9, 5.10512e+16,
    1.28579e+9, 5.71096e+16,
    1.53851e+9, 6.40640e+16,
    1.84092e+9, 7.17658e+16,
    2.20275e+9, 8.08401e+16,
    2.63571e+9, 9.06842e+16,
    3.15377e+9, 1.00607e+17,
    3.77366e+9, 1.10845e+17,
    4.51539e+9, 1.20947e+17,
    5.40290e+9, 1.31423e+17,
    6.46486e+9, 1.42806e+17,
    7.73556e+9, 1.54318e+17,
    9.25601e+9, 1.66990e+17,
    1.10753e+10, 1.80202e+17,
    1.32522e+10, 1.94729e+17,
    1.58570e+10, 2.10136e+17,
    1.89737e+10, 2.27076e+17,
    2.27031e+10, 2.44703e+17,
    2.71655e+10, 2.64430e+17,
    3.25049e+10, 2.84956e+17,
    3.88939e+10, 3.07928e+17,
    4.65386e+10, 3.31832e+17,
    5.56860e+10, 3.59079e+17,
    6.66313e+10, 3.86418e+17,
    7.97279e+10, 4.15838e+17,
    9.15863e+10, 4.41549e+17,
]).reshape(-1, 2)

nutau_exposure_7yr = np.array([
    5.37691e+5, 1.10217e+12,
    5.79172e+5, 1.66838e+12,
    6.21596e+5, 2.44226e+12,
    6.74423e+5, 3.39353e+12,
    7.37731e+5, 4.84884e+12,
    8.13592e+5, 6.86525e+12,
    8.97254e+5, 9.52479e+12,
    9.89518e+5, 1.32146e+13,
    1.10021e+6, 1.86896e+13,
    1.25358e+6, 2.61343e+13,
    1.45183e+6, 3.66596e+13,
    1.68143e+6, 5.14238e+13,
    1.96328e+6, 7.11400e+13,
    2.33009e+6, 9.91511e+13,
    2.76543e+6, 1.37771e+14,
    3.25544e+6, 1.89693e+14,
    3.86367e+6, 2.62778e+14,
    4.62309e+6, 3.54374e+14,
    5.53177e+6, 4.60364e+14,
    6.61906e+6, 5.94751e+14,
    7.92007e+6, 7.71567e+14,
    9.47678e+6, 9.99563e+14,
    1.13395e+7, 1.23539e+15,
    1.35683e+7, 1.44460e+15,
    1.62352e+7, 1.68690e+15,
    1.94263e+7, 1.96984e+15,
    2.32446e+7, 2.30023e+15,
    2.78134e+7, 2.68233e+15,
    3.32802e+7, 3.13224e+15,
    3.98216e+7, 3.65760e+15,
    4.76487e+7, 4.27108e+15,
    5.70142e+7, 4.98746e+15,
    6.82206e+7, 5.82400e+15,
    8.16296e+7, 6.79144e+15,
    9.76742e+7, 7.93056e+15,
    1.16872e+8, 9.26074e+15,
    1.39844e+8, 1.08891e+16,
    1.67331e+8, 1.28572e+16,
    2.00220e+8, 1.50971e+16,
    2.39575e+8, 1.78009e+16,
    2.86664e+8, 2.09311e+16,
    3.43009e+8, 2.47825e+16,
    4.10428e+8, 2.92616e+16,
    4.91099e+8, 3.44546e+16,
    5.87627e+8, 3.95707e+16,
    7.03127e+8, 4.45124e+16,
    8.41329e+8, 5.00713e+16,
    1.00670e+9, 5.61686e+16,
    1.20457e+9, 6.31831e+16,
    1.44133e+9, 7.08772e+16,
    1.72463e+9, 7.97286e+16,
    2.06361e+9, 8.95613e+16,
    2.46922e+9, 1.00746e+17,
    2.95455e+9, 1.11615e+17,
    3.53528e+9, 1.22463e+17,
    4.23015e+9, 1.34553e+17,
    5.06160e+9, 1.47631e+17,
    6.05648e+9, 1.61980e+17,
    7.24690e+9, 1.77971e+17,
    8.67131e+9, 1.95269e+17,
    1.03757e+10, 2.14545e+17,
    1.24151e+10, 2.33775e+17,
    1.48553e+10, 2.52970e+17,
    1.77752e+10, 2.74501e+17,
    2.12689e+10, 2.97865e+17,
    2.54494e+10, 3.23217e+17,
    3.04516e+10, 3.49757e+17,
    3.64370e+10, 3.80051e+17,
    4.35988e+10, 4.10120e+17,
    5.21683e+10, 4.45027e+17,
    6.24222e+10, 4.82236e+17,
    7.46915e+10, 5.24005e+17,
    8.72120e+10, 5.61952e+17,
]).reshape(-1, 2)

LIVETIME_7YR = 2426 * 24 * 3600
CM2_IN_M2 = 1e4
SOLID_ANGLE = 4 * np.pi

nue_aeff_7yr = copy(nue_exposure_7yr)
nue_aeff_7yr[:, 1] /= (LIVETIME_7YR * CM2_IN_M2 * SOLID_ANGLE)

numu_aeff_7yr = copy(numu_exposure_7yr)
numu_aeff_7yr[:, 1] /= (LIVETIME_7YR * CM2_IN_M2 * SOLID_ANGLE)

nutau_aeff_7yr = copy(nutau_exposure_7yr)
nutau_aeff_7yr[:, 1] /= (LIVETIME_7YR * CM2_IN_M2 * SOLID_ANGLE)

